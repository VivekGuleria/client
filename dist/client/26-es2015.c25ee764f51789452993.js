(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{ijJw:function(e,t,c){"use strict";c.r(t),c.d(t,"ServiceProviderConfigModule",(function(){return ut}));var i=c("SVse"),r=c("iInd"),n=c("s7LF"),a=c("LvDl"),o=c("8Y7J");let s=(()=>{class e{transform(e,t,c){return t?a.filter(e,e=>null!=e.searched&&!(-1===e.searched.toString().search(RegExp(t,"i")))):e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=o.Ub({name:"dataFilter",type:e,pure:!0}),e})();var l=c("7g+E"),d=c("qfBg"),f=c("/mFJ"),u=c("OC8m"),b=c("wTG2"),g=c("bOtU"),h=c("ienR");function m(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Contract ID is required "),o.ac())}function v(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,m,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.contractID.errors.required)}}function p(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Store Name & Code is required "),o.ac())}function I(e,t){if(1&e&&(o.bc(0,"div",27),o.Oc(1,p,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.storeID.errors.required)}}function D(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Service Provider ID is required "),o.ac())}function C(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,D,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.serviceProviderID.errors.required)}}function S(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Revenue Share is required "),o.ac())}function y(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,S,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.percentageTxnCharges.errors.required)}}function R(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," GST Rate is required "),o.ac())}function O(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,R,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.gstRate.errors.required)}}function P(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," TDS Rate is required "),o.ac())}function Q(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,P,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.tdsRate.errors.required)}}function w(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Effective Rate is required "),o.ac())}function M(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,w,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.effectiveRate.errors.required)}}function k(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Effective Date is required "),o.ac())}function x(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,k,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.effectiveDate.errors.required)}}const F=function(e){return{"is-invalid":e}},L=function(e){return{error:e}},V=function(){return{isAnimated:!0,dateInputFormat:"MM/DD/YYYY",timezone:"UTC"}};let T=(()=>{class e{constructor(e,t,c,i,r,n,a){this.formBuilder=e,this.spinner=t,this.userService=c,this.serviceConfigurationService=i,this.dataFilter=r,this.notification=n,this.router=a,this.formSubmitted=!1,this.minDate=new Date,this.localDetails={},this.serviceProviderList=[],this.gstRate="00.00",this.revenue="00.00",this.tdsRate="00.00",this.effectiveRate="00.00"}ngOnInit(){localStorage.getItem("service-config")&&(this.localDetails=JSON.parse(localStorage.getItem("service-config")),this.selectedContractID=this.localDetails.contractId),this.minDate.setDate(this.minDate.getDate()+1),this.getDropdownVals(),this.getServiceProviders(),this.createForm()}getDropdownVals(){const e=[];this.serviceConfigurationService.getStoreDropdown({}).subscribe(t=>{t&&(t.forEach(t=>{e.push({label:t.storeId+" - "+t.storeName,value:t.storeId,contractId:t.contractId})}),this.storeList=e,this.allList=e)})}getServiceProviders(){let e=[];this.serviceConfigurationService.getServiceProviderList({merchantId:this.userService.userValue.merchantId}).subscribe(t=>{t&&(t.forEach(t=>{e.push({label:t.providerId+" - "+t.providerName,value:t.providerId})}),this.serviceProviderList=e)})}searchStore(e){if(!this.selectedContractID)return this.storeList=[];this.storeList=this.dataFilter.transform(this.allList,e.target.value)}createForm(){var e,t,c,i;this.revenueConfigForm=this.formBuilder.group({merchantID:[null===(e=this.localDetails)||void 0===e?void 0:e.merchantId,[n.y.required]],contractID:[null===(t=this.localDetails)||void 0===t?void 0:t.contractId,[n.y.required]],serviceProviderID:[null,[n.y.required]],storeName:[null===(c=this.localDetails)||void 0===c?void 0:c.storeName,[n.y.required]],storeID:[null===(i=this.localDetails)||void 0===i?void 0:i.storeId,[n.y.required]],gstRate:[null,[n.y.required]],tdsRate:[null,[n.y.required]],percentageTxnCharges:[null,[n.y.required]],effectiveRate:[null,[n.y.required]],effectiveDate:[null,[n.y.required]]}),console.log(this.localDetails)}get f(){return this.revenueConfigForm.controls}isNumber(e){var t=e.which?e.which:e.keyCode;return!(46!=t&&t>31&&(t<48||t>57)||e.target.value.indexOf(".")>-1&&e.target.value.split(".")[1].length>1||e.target.value.indexOf(".")>=0&&46==t)}formatData(e,t){let c;c=e<10?"0"+Number(e).toFixed(2):Number(e)?Number(e).toFixed(2):"00.00","gst"===t&&(this.gstRate=c),"tds"===t&&(this.tdsRate=c),"revenue"===t&&(this.revenue=c),this.effectiveRate=parseFloat(this.revenue)/(100+parseFloat(this.gstRate))*(100-parseFloat(this.tdsRate)),this.effectiveRate=this.effectiveRate.toFixed(2)}create(){console.log(this.revenueConfigForm);let e=this.revenueConfigForm.value;if(e.createdBy=this.userService.userValue.userName,e.fixedTxnCharges=0,e.effectiveFixedAmount=0,e.isTxnChargesOnGross=0,e.minTxnCharges=null,e.maxTxnCharges=null,e.isEdit=!1,e.effectiveRate=this.effectiveRate,this.spinner.show(),this.formSubmitted=!0,this.revenueConfigForm.invalid)return console.log("hello"),console.log(this.revenueConfigForm.invalid),void this.spinner.hide();this.serviceConfigurationService.saveConfig(e).subscribe(e=>{this.spinner.hide(),this.notification.showSuccess("Saved Successfully!",""),this.router.navigate(["/service-provider/revenue-share-config"])},e=>{this.spinner.hide()})}}return e.\u0275fac=function(t){return new(t||e)(o.Vb(n.c),o.Vb(l.c),o.Vb(d.a),o.Vb(f.a),o.Vb(s),o.Vb(u.a),o.Vb(r.c))},e.\u0275cmp=o.Pb({type:e,selectors:[["app-add-revenue-share-config"]],features:[o.Hb([s])],decls:58,vars:48,consts:[["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-spin-fade",3,"fullScreen"],[2,"color","white"],[1,"animated","fadeIn"],[1,"card","mt-3"],[1,"card-header","pt-0",2,"font-weight","700"],[1,"fa","fa-th-large","ml-2","mt-3"],[1,"card-body"],[3,"formGroup"],[1,"row","mb-3"],[1,"col-md-4"],["type","text","autocomplete","off","formControlName","contractID","disabled","",1,"form-control",3,"ngModel","ngClass","keyup","ngModelChange"],["class","invalid-feedback",4,"ngIf"],["bindLabel","label","bindValue","value","appendTo","body","formControlName","storeID",3,"items","searchable","ngClass","readonly"],["style","font-size: 80%;color: #f86c6b;",4,"ngIf"],["appendTo","body","bindLabel","label","bindValue","value","formControlName","serviceProviderID",3,"items","searchable","ngClass"],["type","text","autocomplete","off","formControlName","percentageTxnCharges","mask","00.00",1,"form-control",2,"width","100%",3,"ngClass","ngModel","blur","ngModelChange"],["type","text","autocomplete","off","formControlName","gstRate","mask","00.00",1,"form-control",3,"ngClass","ngModel","blur","ngModelChange"],["type","text","autocomplete","off","mask","00.00","formControlName","tdsRate",1,"form-control",2,"width","100%",3,"ngClass","ngModel","blur","ngModelChange"],["type","text","autocomplete","off","formControlName","effectiveRate","disabled","",1,"form-control",2,"width","100%",3,"ngClass","ngModel","ngModelChange"],["type","text","bsDatepicker","","formControlName","effectiveDate",1,"form-control",3,"bsConfig","ngModel","ngClass","minDate","ngModelChange"],[1,"row","mt-3"],[1,"col-md-8"],[1,"col-md-4","d-flex"],["type","submit",1,"btn","btn-block","btn-primary","p-2","mt-2",3,"click"],["routerLink","/service-provider/revenue-share-config",1,"btn","btn-block","btn-danger","p-2","mt-2","ml-2"],[1,"invalid-feedback"],[4,"ngIf"],[2,"font-size","80%","color","#f86c6b"]],template:function(e,t){1&e&&(o.bc(0,"ngx-spinner",0),o.bc(1,"p",1),o.Qc(2,"Loading..."),o.ac(),o.ac(),o.bc(3,"div",2),o.bc(4,"div",3),o.bc(5,"div",4),o.Wb(6,"i",5),o.Qc(7," Add Store Configuration "),o.ac(),o.bc(8,"div",6),o.bc(9,"form",7),o.bc(10,"div",8),o.bc(11,"div",9),o.bc(12,"label"),o.Qc(13,"Contract ID"),o.ac(),o.bc(14,"input",10),o.jc("keyup",(function(e){return t.searchStore(e)}))("ngModelChange",(function(e){return t.selectedContractID=e})),o.ac(),o.Oc(15,v,2,1,"div",11),o.ac(),o.bc(16,"div",9),o.bc(17,"label"),o.Qc(18,"Store Name & Store Code"),o.ac(),o.Wb(19,"ng-select",12),o.Oc(20,I,2,1,"div",13),o.ac(),o.bc(21,"div",9),o.bc(22,"label"),o.Qc(23,"Service Provider ID"),o.ac(),o.Wb(24,"ng-select",14),o.Oc(25,C,2,1,"div",11),o.ac(),o.bc(26,"div",9),o.bc(27,"label"),o.Qc(28,"Revenue Share (%)"),o.ac(),o.bc(29,"input",15),o.jc("blur",(function(e){return t.formatData(e.target.value,"revenue")}))("ngModelChange",(function(e){return t.revenue=e})),o.ac(),o.Oc(30,y,2,1,"div",11),o.ac(),o.bc(31,"div",9),o.bc(32,"label"),o.Qc(33,"GST Rate (%)"),o.ac(),o.bc(34,"input",16),o.jc("blur",(function(e){return t.formatData(e.target.value,"gst")}))("ngModelChange",(function(e){return t.gstRate=e})),o.ac(),o.Oc(35,O,2,1,"div",11),o.ac(),o.bc(36,"div",9),o.bc(37,"label"),o.Qc(38,"TDS Rate (%)"),o.ac(),o.bc(39,"input",17),o.jc("blur",(function(e){return t.formatData(e.target.value,"tds")}))("ngModelChange",(function(e){return t.tdsRate=e})),o.ac(),o.Oc(40,Q,2,1,"div",11),o.ac(),o.bc(41,"div",9),o.bc(42,"label"),o.Qc(43,"Effective Rate (%)"),o.ac(),o.bc(44,"input",18),o.jc("ngModelChange",(function(e){return t.effectiveRate=e})),o.ac(),o.Oc(45,M,2,1,"div",11),o.ac(),o.bc(46,"div",9),o.bc(47,"label"),o.Qc(48,"Effective Date "),o.ac(),o.bc(49,"input",19),o.jc("ngModelChange",(function(e){return t.effectiveDate=e})),o.ac(),o.Oc(50,x,2,1,"div",11),o.ac(),o.ac(),o.bc(51,"div",20),o.Wb(52,"div",21),o.bc(53,"div",22),o.bc(54,"button",23),o.jc("click",(function(){return t.create()})),o.Qc(55," Create "),o.ac(),o.bc(56,"button",24),o.Qc(57," Cancel "),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.ac()),2&e&&(o.uc("fullScreen",!0),o.Ib(9),o.uc("formGroup",t.revenueConfigForm),o.Ib(5),o.uc("ngModel",t.selectedContractID)("ngClass",o.yc(31,F,t.formSubmitted&&t.f.contractID.errors)),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.contractID.errors),o.Ib(4),o.uc("items",t.storeList)("searchable",!0)("ngClass",o.yc(33,L,t.formSubmitted&&t.f.storeID.errors))("readonly",!0),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.storeID.errors),o.Ib(4),o.uc("items",t.serviceProviderList)("searchable",!0)("ngClass",o.yc(35,L,t.formSubmitted&&t.f.serviceProviderID.errors)),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.serviceProviderID.errors),o.Ib(4),o.uc("ngClass",o.yc(37,F,t.formSubmitted&&t.f.percentageTxnCharges.errors))("ngModel",t.revenue),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.percentageTxnCharges.errors),o.Ib(4),o.uc("ngClass",o.yc(39,F,t.formSubmitted&&t.f.gstRate.errors))("ngModel",t.gstRate),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.gstRate.errors),o.Ib(4),o.uc("ngClass",o.yc(41,F,t.formSubmitted&&t.f.tdsRate.errors))("ngModel",t.tdsRate),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.tdsRate.errors),o.Ib(4),o.uc("ngClass",o.yc(43,F,t.formSubmitted&&t.f.effectiveRate.errors))("ngModel",t.effectiveRate),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.effectiveRate.errors),o.Ib(4),o.uc("bsConfig",o.xc(45,V))("ngModel",t.effectiveDate)("ngClass",o.yc(46,F,t.formSubmitted&&t.f.effectiveDate.errors))("minDate",t.minDate),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.effectiveDate.errors))},directives:[l.a,n.A,n.o,n.h,n.b,n.n,n.f,i.l,i.n,b.a,g.a,h.b,h.a,r.d],styles:["label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:2px;padding-top:10px}.error[_ngcontent-%COMP%]{border:1px solid #f86c6b;border-radius:4%}  .ng-select-disabled .ng-arrow-wrapper{cursor:default;display:none!important}"]}),e})();var N=c("VHTt"),q=c("PSD3"),A=c.n(q),E=c("LqlI"),j=c("q17e"),$=c("xkgV");function _(e,t){if(1&e&&(o.bc(0,"div",29),o.bc(1,"p"),o.bc(2,"strong"),o.Qc(3,"Contract ID :"),o.ac(),o.Qc(4),o.bc(5,"strong"),o.Qc(6,"Store Code :"),o.ac(),o.Qc(7),o.bc(8,"strong"),o.Qc(9,"Store Name :"),o.ac(),o.Qc(10),o.ac(),o.ac()),2&e){const e=o.nc();o.Ib(4),o.Sc(" ",null==e.filterQueryStoreID?null:e.filterQueryStoreID.contractId," , \xa0 "),o.Ib(3),o.Sc(" ",null==e.filterQueryStoreID?null:e.filterQueryStoreID.value," , \xa0 "),o.Ib(3),o.Sc(" ",null==e.filterQueryStoreID?null:e.filterQueryStoreID.name," \xa0 ")}}function U(e,t){if(1&e&&(o.bc(0,"th",30),o.Qc(1),o.ac()),2&e){const e=t.$implicit;o.Ib(1),o.Sc(" ",e.label," ")}}function G(e,t){1&e&&(o.bc(0,"th",31),o.Qc(1,"Actions"),o.ac())}function z(e,t){if(1&e&&(o.bc(0,"span"),o.Qc(1),o.ac()),2&e){const e=o.nc().$implicit,t=o.nc().$implicit;o.Ib(1),o.Rc(t[e.field]+"%")}}const B=function(){return{visibility:"hidden"}},W=function(){return{visibility:"visible"}};function Y(e,t){if(1&e){const e=o.cc();o.bc(0,"i",37),o.jc("click",(function(){o.Ic(e);const t=o.nc(3).$implicit,c=o.nc(2),i=o.Fc(40);return c.openEditModal(i,t)})),o.ac()}if(2&e){const e=o.nc(3).$implicit,t=o.nc(2);o.uc("ngStyle",e.createdBy==t.userName||e.checkerEffectiveDate>t.currentDate?o.xc(1,B):o.xc(2,W))}}function H(e,t){if(1&e&&(o.bc(0,"span"),o.Qc(1),o.oc(2,"date"),o.Oc(3,Y,1,3,"i",36),o.ac()),2&e){const e=o.nc(2).$implicit;o.Ib(1),o.Sc("",o.qc(2,2,e.effectiveDate,"dd/MM/yyyy")," "),o.Ib(2),o.uc("ngIf",e.isPast)}}function J(e,t){if(1&e&&(o.bc(0,"span"),o.Qc(1),o.ac()),2&e){const e=o.nc(2).$implicit;o.Ib(1),o.Rc(e.status)}}function Z(e,t){if(1&e&&(o.bc(0,"span"),o.Qc(1),o.ac()),2&e){const e=o.nc(2).$implicit;o.Ib(1),o.Rc(e.serviceProviderID)}}function K(e,t){if(1&e&&(o.bc(0,"td",30),o.Oc(1,z,2,1,"span",20),o.Oc(2,H,4,5,"span",20),o.Oc(3,J,2,1,"span",20),o.Oc(4,Z,2,1,"span",20),o.ac()),2&e){const e=t.$implicit;o.Ib(1),o.uc("ngIf","effectiveDate"!==e.field&&"status"!==e.field&&"serviceProviderID"!==e.field),o.Ib(1),o.uc("ngIf","effectiveDate"===e.field),o.Ib(1),o.uc("ngIf","status"===e.field),o.Ib(1),o.uc("ngIf","serviceProviderID"===e.field)}}function X(e,t){if(1&e){const e=o.cc();o.bc(0,"button",38),o.jc("click",(function(){o.Ic(e);const t=o.nc().$implicit;return o.nc(2).actionApply(t,"Approve")})),o.Qc(1,"Approve"),o.ac()}if(2&e){const e=o.nc().$implicit,t=o.nc(2);o.vc("title",e.createdBy==t.userName?"You cannnot approve self added configuration":""),o.uc("disabled",t.isDisabled(e))}}function ee(e,t){if(1&e){const e=o.cc();o.bc(0,"button",39),o.jc("click",(function(){o.Ic(e);const t=o.nc().$implicit;return o.nc(2).actionApply(t,"Reject")})),o.Qc(1,"Reject"),o.ac()}if(2&e){const e=o.nc().$implicit,t=o.nc(2);o.vc("title",e.createdBy==t.userName?"You Cannnot reject self added configuration":""),o.uc("disabled",t.isDisabled(e))}}const te=function(e){return[e]};function ce(e,t){if(1&e&&(o.bc(0,"tr"),o.Oc(1,K,5,4,"td",33),o.bc(2,"td",31),o.Oc(3,X,2,2,"button",34),o.Oc(4,ee,2,2,"button",35),o.ac(),o.ac()),2&e){const e=o.nc(2);o.Ib(1),o.uc("ngForOf",e.cols),o.Ib(2),o.uc("appUserAccess",o.yc(3,te,e.roleAccess.storeConfigurationApprovalChecker)),o.Ib(1),o.uc("appUserAccess",o.yc(5,te,e.roleAccess.storeConfigurationApprovalChecker))}}const ie=function(e,t){return{itemsPerPage:e,currentPage:t}};function re(e,t){if(1&e&&(o.bc(0,"tbody"),o.Oc(1,ce,5,7,"tr",32),o.oc(2,"paginate"),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngForOf",o.qc(2,1,e.revenueShareList,o.zc(4,ie,e.itemsPerPage,e.page)))}}function ne(e,t){1&e&&(o.bc(0,"div",40),o.bc(1,"a",41),o.Qc(2," No Data found ! "),o.Wb(3,"br"),o.ac(),o.ac())}function ae(e,t){if(1&e){const e=o.cc();o.bc(0,"div",42),o.jc("click",(function(){o.Ic(e);const c=t.$implicit;return o.nc().itemOnPage(c)})),o.Qc(1),o.ac()}if(2&e){const e=t.$implicit,c=o.nc();o.uc("ngClass",c.itemsPerPage==e?"item-number-active":"item-number"),o.Ib(1),o.Sc(" ",e,"")}}const oe=function(){return{isAnimated:!0,dateInputFormat:"dd/MM/yyyy",timezone:"UTC"}};function se(e,t){if(1&e){const e=o.cc();o.bc(0,"div",43),o.bc(1,"h6"),o.Wb(2,"i",44),o.Qc(3,"Upadte Checker Effective Date"),o.ac(),o.bc(4,"button",45),o.jc("click",(function(){return o.Ic(e),o.nc().modalRef.hide()})),o.bc(5,"span",46),o.Qc(6,"\xd7"),o.ac(),o.ac(),o.ac(),o.bc(7,"div",47),o.bc(8,"form",48),o.bc(9,"div",49),o.Qc(10,"Effective From"),o.ac(),o.Wb(11,"input",50),o.ac(),o.ac(),o.bc(12,"div",51),o.bc(13,"button",52),o.jc("click",(function(){return o.Ic(e),o.nc().updateRecord()})),o.Qc(14,"Update"),o.ac(),o.bc(15,"button",53),o.jc("click",(function(){return o.Ic(e),o.nc().close()})),o.Qc(16,"Cancel"),o.ac(),o.ac()}if(2&e){const e=o.nc();o.Ib(8),o.uc("formGroup",e.editCheckerRecordForm),o.Ib(3),o.uc("bsConfig",o.xc(3,oe))("minDate",e.minDate)}}let le=(()=>{class e{constructor(e,t,c,i,r,n,a,o,s){this.router=e,this.spinner=t,this.serviceConfigurationService=c,this.dataFilter=i,this.notification=r,this.userService=n,this.modalService=a,this.formBuilder=o,this.notificationService=s,this.cols=[{label:"Service Provider ID",field:"serviceProviderID"},{label:"Revenue Share ",field:"percentageTxnCharges"},{label:"GST Rate ",field:"gstRate"},{label:"TDS Rate ",field:"tdsRate"},{label:"Effective Rate ",field:"effectiveRate"},{label:"Effective From",field:"effectiveDate"},{label:"Status",field:"status"}],this.roleAccess=N.a,this.filterQueryStoreID=null,this.filterQueryContractID=null,this.minDate=new Date,this.itemsPerPage=10,this.page=1,this.storeList=[],this.revenueShareList=[],this.searchedData=!1,this.isChecker=!1,this.itemPerPage=[10,15,20,25],this.merchantIds=[]}ngOnInit(){this.userName=this.userService.userValue.userName,this.currentDate=(new Date).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),this.minDate.setDate(this.minDate.getDate()+1),this.getDropdownVals()}openEditModal(e,t){this.modalRef=this.modalService.show(e),this.selectedRecord=t,this.createForm()}createForm(){this.editCheckerRecordForm=this.formBuilder.group({effectiveDate:[""]})}get f(){return this.editCheckerRecordForm.controls}getDropdownVals(){const e=[];this.serviceConfigurationService.getStoreDropdown({merchantId:this.userService.userValue.merchantId}).subscribe(t=>{console.log(t.length),t&&(t.forEach(t=>{e.push({label:t.storeId+" - "+t.storeName,value:t.storeId,contractId:t.contractId,name:t.storeName,searched:t.storeId+"-"+t.storeName+"-"+t.contractId,merchantId:t.merchantid}),this.merchantIds.push(t.merchantid)}),0!=t.length&&this.displayData(),this.allList=e)})}searchStore(e){if(!this.filterQueryContractID)return this.storeList=[];this.storeList=this.dataFilter.transform(this.allList,e.target.value),this.filterQueryStoreID=null}itemOnPage(e){this.page=0,this.itemsPerPage=e}getPage(){return this.itemsPerPage?this.itemsPerPage:10}getData(e,t){return!e||"effectiveRate"!==t&&"gstRate"!==t&&"tdsRate"!==t&&"fixedTxnCharges"!==t?e:e+" %"}displayData(){this.spinner.show();const e={};e.merchantIds=this.filterQueryStoreID?[this.filterQueryStoreID.merchantId]:this.merchantIds,this.serviceConfigurationService.getChekerList(e).subscribe(e=>{this.revenueShareList=e,this.totalRecords=this.revenueShareList?this.revenueShareList.length:0,this.revenueShareList=this.revenueShareList.sort((function(e,t){return t.effectiveDate-e.effectiveDate}));const t=(new Date).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"});this.revenueShareList.forEach(e=>{e.effectiveDate=new Date(e.effectiveDate).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),e.effectiveDate<=t&&Object.assign(e,{isPast:!0})}),this.spinner.hide()})}updateRecord(){this.serviceConfigurationService.updateCheckerListRecord({configId:this.selectedRecord.configId,checkerEffectiveDate:this.editCheckerRecordForm.controls.effectiveDate.value}).subscribe(e=>{console.log(e),1==e?(this.notificationService.showSuccess("Updated Successfully",""),this.close(),this.displayData()):this.notificationService.showError("Update failed","")})}searchFnc(){if(!this.filterQueryContractID||!this.filterQueryStoreID)return this.notification.showInfo("Please enter Valid contract ID , Store Name or Store Code","");this.searchedData=!0,this.displayData()}actionApply(e,t){var c;if(console.log(e.checkerEffectiveDate,this.currentDate),e.checkerEffectiveDate<=this.currentDate)A.a.fire({title:"Message",text:"Please update current effective date to future date"});else{const i={configId:null===(c=e)||void 0===c?void 0:c.configId,action:t.toUpperCase(),isEdit:!!e.isEdit&&e.isEdit};A.a.fire({text:`Are you sure you want to ${t} this Record ?`,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then(e=>{e.isConfirmed&&this.serviceConfigurationService.setStatus(i).subscribe(e=>{this.displayData()})})}}isDisabled(e){return(new Date).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),e.checkerEffectiveDate=new Date(e.checkerEffectiveDate).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),e.createdBy===this.userService.userValue.userName}close(){this.modalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(o.Vb(r.c),o.Vb(l.c),o.Vb(f.a),o.Vb(s),o.Vb(u.a),o.Vb(d.a),o.Vb(E.b),o.Vb(n.c),o.Vb(u.a))},e.\u0275cmp=o.Pb({type:e,selectors:[["app-checker"]],features:[o.Hb([s])],decls:41,vars:13,consts:[["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-spin-fade",3,"fullScreen"],[2,"color","white"],[1,"animated","fadeIn"],[1,"card","mt-3"],[1,"card-header","pt-0",2,"font-weight","700"],[1,"fa","fa-check-square-o","ml-2","mt-3"],[1,"card-body","pb-0","pt-2"],[1,"row","mb-3"],[1,"col-md-4"],[1,"input-group"],["type","text",1,"form-control",3,"ngModel","ngModelChange","keyup"],["bindLabel","label","appendTo","body",3,"items","searchable","ngModel","ngModelChange"],[1,"col-md-4","pt-4"],[1,"btn","btn-primary","mt-1",3,"click"],["style","margin-top:-10px ;","class","pb-2 pl-2",4,"ngIf"],[1,"card",2,"margin-top","-15px"],[1,"card-body","pt-1","pl-1","pr-1","pb-0",2,"overflow-x","scroll"],[1,"table","table-responsive-lg"],["class","p-2","style","text-align: center;",4,"ngFor","ngForOf"],["style","text-align: center;",4,"appUserAccess"],[4,"ngIf"],["class","pb-2","style","text-align:center;",4,"ngIf"],[1,"card-footer","pt-2","pb-1"],[1,"row"],[1,"mt-1"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"col-md-8"],[1,"float-right","mr-1",3,"pageChange"],["template",""],[1,"pb-2","pl-2",2,"margin-top","-10px"],[1,"p-2",2,"text-align","center"],[2,"text-align","center"],[4,"ngFor","ngForOf"],["class","p-2","style","text-align: center",4,"ngFor","ngForOf"],["class","btn btn-sm btn-primary p-0 pl-2 pr-2 ",3,"title","disabled","click",4,"appUserAccess"],["class","btn btn-sm btn-danger ml-2 p-0 pl-2 pr-2",3,"title","disabled","click",4,"appUserAccess"],["class","fa fa-pencil","data-toggle","tooltip","data-placement","top","title","Edit effective date",3,"ngStyle","click",4,"ngIf"],["data-toggle","tooltip","data-placement","top","title","Edit effective date",1,"fa","fa-pencil",3,"ngStyle","click"],[1,"btn","btn-sm","btn-primary","p-0","pl-2","pr-2",3,"title","disabled","click"],[1,"btn","btn-sm","btn-danger","ml-2","p-0","pl-2","pr-2",3,"title","disabled","click"],[1,"pb-2",2,"text-align","center"],["href","javascript:void(0)",2,"font-size","16px","font-weight","500"],[3,"ngClass","click"],[1,"modal-header"],[1,"fa","fa-align-justify","mr-2"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup"],[1,"heading"],["type","text","bsDatepicker","","autocomplete","off","formControlName","effectiveDate",1,"form-control",3,"bsConfig","minDate"],[1,"modal-footer"],[1,"btn","btn-success",3,"click"],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(o.bc(0,"ngx-spinner",0),o.bc(1,"p",1),o.Qc(2,"Loading..."),o.ac(),o.ac(),o.bc(3,"div",2),o.bc(4,"div",3),o.bc(5,"div",4),o.Wb(6,"i",5),o.Qc(7," Checker List "),o.ac(),o.bc(8,"div",6),o.bc(9,"div",7),o.bc(10,"div",8),o.bc(11,"label"),o.Qc(12," Contract ID , Store Name or Store Code"),o.ac(),o.bc(13,"div",9),o.bc(14,"input",10),o.jc("ngModelChange",(function(e){return t.filterQueryContractID=e}))("keyup",(function(e){return t.searchStore(e)})),o.ac(),o.ac(),o.ac(),o.bc(15,"div",8),o.bc(16,"label"),o.Qc(17," Store Code "),o.ac(),o.bc(18,"ng-select",11),o.jc("ngModelChange",(function(e){return t.filterQueryStoreID=e})),o.ac(),o.ac(),o.bc(19,"div",12),o.bc(20,"button",13),o.jc("click",(function(){return t.searchFnc()})),o.Qc(21," Search"),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.Oc(22,_,11,3,"div",14),o.bc(23,"div",15),o.bc(24,"div",16),o.bc(25,"table",17),o.bc(26,"thead"),o.bc(27,"tr"),o.Oc(28,U,2,1,"th",18),o.Oc(29,G,2,0,"th",19),o.ac(),o.ac(),o.Oc(30,re,3,7,"tbody",20),o.ac(),o.Oc(31,ne,4,0,"div",21),o.ac(),o.bc(32,"div",22),o.bc(33,"div",23),o.bc(34,"div",8),o.bc(35,"div",24),o.Oc(36,ae,2,2,"div",25),o.ac(),o.ac(),o.bc(37,"div",26),o.bc(38,"pagination-controls",27),o.jc("pageChange",(function(e){return t.page=e})),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.Oc(39,se,17,4,"ng-template",null,28,o.Pc)),2&e&&(o.uc("fullScreen",!0),o.Ib(14),o.uc("ngModel",t.filterQueryContractID),o.Ib(4),o.uc("items",t.storeList)("searchable",!0)("ngModel",t.filterQueryStoreID),o.Ib(4),o.uc("ngIf",t.searchedData&&t.filterQueryStoreID),o.Ib(6),o.uc("ngForOf",t.cols),o.Ib(1),o.uc("appUserAccess",o.yc(11,te,t.roleAccess.storeConfigurationApprovalChecker)),o.Ib(1),o.uc("ngIf",t.revenueShareList.length>0),o.Ib(1),o.uc("ngIf",0===t.totalRecords),o.Ib(5),o.uc("ngForOf",t.itemPerPage))},directives:[l.a,n.b,n.n,n.q,b.a,i.n,i.m,j.a,$.c,i.o,i.l,n.A,n.o,n.h,h.b,h.a,n.f],pipes:[$.b,i.e],styles:[".card[_ngcontent-%COMP%]{width:100%!important}.item-number[_ngcontent-%COMP%], .item-number-active[_ngcontent-%COMP%]{display:inline-block;border:1px solid hsla(0,0%,50.2%,.7);padding-left:9px;padding-right:9px;padding-top:2px;height:30px;cursor:pointer;margin:1px}.item-number-active[_ngcontent-%COMP%]{background-color:#2199e8;color:#fff}th[_ngcontent-%COMP%]{border-top:none}label[_ngcontent-%COMP%]{font-weight:500}.badge[_ngcontent-%COMP%]{font-size:13px;color:#fff}th[_ngcontent-%COMP%]{white-space:nowrap}.highlight[_ngcontent-%COMP%]{background-color:#0ff}.grey-color[_ngcontent-%COMP%]{background-color:#ededed}.azure-color[_ngcontent-%COMP%]{background-color:#faffff}.heading[_ngcontent-%COMP%]{font-weight:700}"]}),e})(),de=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Pb({type:e,selectors:[["app-revenue-share-config-details"]],decls:2,vars:0,template:function(e,t){1&e&&(o.bc(0,"p"),o.Qc(1,"revenue-share-config-details works!"),o.ac())},styles:[""]}),e})();function fe(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Contract ID is required "),o.ac())}function ue(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,fe,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.contractID.errors.required)}}function be(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Store Name & Code is required "),o.ac())}function ge(e,t){if(1&e&&(o.bc(0,"div",27),o.Oc(1,be,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.storeID.errors.required)}}function he(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Service Provider ID is required "),o.ac())}function me(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,he,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.serviceProviderID.errors.required)}}function ve(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Revenue Share is required "),o.ac())}function pe(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,ve,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.percentageTxnCharges.errors.required)}}function Ie(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," GST Rate is required "),o.ac())}function De(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,Ie,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.gstRate.errors.required)}}function Ce(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," TDS Rate is required "),o.ac())}function Se(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,Ce,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.tdsRate.errors.required)}}function ye(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Effective Rate is required "),o.ac())}function Re(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,ye,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.effectiveRate.errors.required)}}function Oe(e,t){1&e&&(o.bc(0,"div"),o.Qc(1," Effective Date is required "),o.ac())}function Pe(e,t){if(1&e&&(o.bc(0,"div",25),o.Oc(1,Oe,2,0,"div",26),o.ac()),2&e){const e=o.nc();o.Ib(1),o.uc("ngIf",e.f.effectiveDate.errors.required)}}const Qe=function(e){return{"is-invalid":e}},we=function(e){return{error:e}},Me=function(){return{isAnimated:!0,dateInputFormat:"MM/DD/YYYY",timezone:"UTC"}};let ke=(()=>{class e{constructor(e,t,c,i,r,n,a){this.formBuilder=e,this.spinner=t,this.modalService=c,this.serviceConfigurationService=i,this.dataFilter=r,this.userService=n,this.notification=a,this.passData=new o.q,this.formSubmitted=!1,this.minDate=new Date,this.serviceProviderList=[]}ngOnInit(){localStorage.getItem("service-config")&&(this.localDetails=JSON.parse(localStorage.getItem("service-config")),this.selectedContractID=this.localDetails.contractId),this.minDate.setDate(this.minDate.getDate()+1),this.getDropdownVals(),this.getServiceProviders(),this.configDetails=this.modalService.config.initialState.data,console.log(this.configDetails),this.configDetails&&this.createForm()}getDropdownVals(){const e=[];this.serviceConfigurationService.getStoreDropdown({}).subscribe(t=>{t&&(t.forEach(t=>{e.push({label:t.storeName+"_"+t.storeId,value:t.storeId,contractId:t.contractId})}),this.storeList=e,this.allList=e)})}getServiceProviders(){let e=[];this.serviceConfigurationService.getServiceProviderList({merchantId:this.userService.userValue.merchantId}).subscribe(t=>{t&&(t.forEach(t=>{e.push({label:t.providerId+" - "+t.providerName,value:t.providerId})}),this.serviceProviderList=e)})}searchStore(e){if(!this.selectedContractID)return this.storeList=[];this.storeList=this.dataFilter.transform(this.allList,e.target.value)}createForm(){var e,t,c,i,r,a,o,s,l,d,f;this.revenueConfigForm=this.formBuilder.group({merchantID:[null===(e=this.localDetails)||void 0===e?void 0:e.merchantId,[n.y.required]],contractID:[null===(t=this.localDetails)||void 0===t?void 0:t.contractId,[n.y.required]],serviceProviderID:[null===(c=this.configDetails)||void 0===c?void 0:c.serviceProviderID,[n.y.required]],storeName:[null===(i=this.localDetails)||void 0===i?void 0:i.storeName,[n.y.required]],storeID:[null===(r=this.localDetails)||void 0===r?void 0:r.storeId,[n.y.required]],gstRate:[null===(a=this.configDetails)||void 0===a?void 0:a.gstRate,[n.y.required]],tdsRate:[null===(o=this.configDetails)||void 0===o?void 0:o.tdsRate,[n.y.required]],percentageTxnCharges:[null===(s=this.configDetails)||void 0===s?void 0:s.percentageTxnCharges,[n.y.required]],effectiveRate:[null===(l=this.configDetails)||void 0===l?void 0:l.effectiveRate,[n.y.required]],effectiveDate:[new Date(null===(d=this.configDetails)||void 0===d?void 0:d.effectiveDate),[n.y.required]]}),this.effectiveDate=new Date(this.configDetails.effectiveDate),this.refId=null===(f=this.configDetails)||void 0===f?void 0:f.configId,this.formatData(this.configDetails.gstRate,"gst"),this.formatData(this.configDetails.tdsRate,"tds"),this.formatData(this.configDetails.percentageTxnCharges,"revenue")}get f(){return this.revenueConfigForm.controls}isNumber(e){var t=e.which?e.which:e.keyCode;return!(46!=t&&t>31&&(t<48||t>57)||e.target.value.indexOf(".")>-1&&e.target.value.split(".")[1].length>1||e.target.value.indexOf(".")>=0&&46==t)}formatData(e,t){let c;c=e<10?"0"+Number(e).toFixed(2):Number(e)?Number(e).toFixed(2):"00.00","gst"===t&&(this.gstRate=c),"tds"===t&&(this.tdsRate=c),"revenue"===t&&(this.revenue=c),this.effectiveRate=parseFloat(this.revenue)/(100+parseFloat(this.gstRate))*(100-parseFloat(this.tdsRate)),this.effectiveRate=this.effectiveRate.toFixed(2)}updateConfig(){this.configDetails.gstRate=this.revenueConfigForm.value.gstRate,this.configDetails.tdsRate=this.revenueConfigForm.value.tdsRate,this.configDetails.percentageTxnCharges=this.revenueConfigForm.value.percentageTxnCharges,this.configDetails.effectiveDate=this.revenueConfigForm.value.effectiveDate,this.configDetails.refId=this.refId,this.configDetails.isEdit=!0,this.configDetails.configId=null,this.spinner.show(),this.formSubmitted=!0,this.revenueConfigForm.invalid?this.spinner.hide():this.serviceConfigurationService.editConfig(this.configDetails).subscribe(e=>{console.log(e),this.notification.showSuccess("Updated Successfully!",""),this.spinner.hide(),this.passData.emit(this.revenueConfigForm.value),this.cancel()},e=>{this.spinner.hide()})}cancel(){this.modalService._hideModal(1)}}return e.\u0275fac=function(t){return new(t||e)(o.Vb(n.c),o.Vb(l.c),o.Vb(E.b),o.Vb(f.a),o.Vb(s),o.Vb(d.a),o.Vb(u.a))},e.\u0275cmp=o.Pb({type:e,selectors:[["app-edit-revenue-share-config"]],outputs:{passData:"passData"},features:[o.Hb([s])],decls:58,vars:51,consts:[["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-spin-fade",3,"fullScreen"],[2,"color","white"],[1,"animated","fadeIn"],[1,"card"],[1,"card-header","pt-0",2,"font-weight","700"],[1,"fa","fa-th-large","ml-2","mt-3"],[1,"card-body"],[3,"formGroup"],[1,"row","mb-3"],[1,"col-md-4"],["type","text","placeholder","Contract ID","autocomplete","off","formControlName","contractID",1,"form-control",3,"ngModel","ngClass","readonly","keyup","ngModelChange"],["class","invalid-feedback",4,"ngIf"],["bindLabel","label","bindValue","value","appendTo","body","formControlName","storeID",3,"items","searchable","ngClass","readonly"],["style","font-size: 80%;color: #f86c6b;",4,"ngIf"],["bindLabel","label","bindValue","value","appendTo","body","formControlName","serviceProviderID",3,"items","searchable","ngClass","readonly"],["type","text","autocomplete","off","formControlName","percentageTxnCharges","mask","00.00",1,"form-control",2,"width","100%",3,"ngClass","ngModel","blur","ngModelChange"],["type","text","placeholder","GST Rate","autocomplete","off","formControlName","gstRate","mask","00.00",1,"form-control",3,"ngClass","ngModel","blur","ngModelChange"],["type","text","placeholder","TDS Rate","autocomplete","off","formControlName","tdsRate","mask","00.00",1,"form-control",2,"width","100%",3,"ngModel","ngClass","blur","ngModelChange"],["type","text","autocomplete","off","formControlName","effectiveRate",1,"form-control",2,"width","100%",3,"ngClass","ngModel","readonly","ngModelChange"],["type","text","placeholder","Effective Date","bsDatepicker","","formControlName","effectiveDate",1,"form-control",3,"bsConfig","ngModel","ngClass","minDate","ngModelChange"],[1,"row","mt-3"],[1,"col-md-8"],[1,"col-md-4","d-flex"],["type","submit",1,"btn","btn-block","btn-primary","p-2","mt-2",3,"click"],[1,"btn","btn-block","btn-danger","p-2","mt-2","ml-2",3,"click"],[1,"invalid-feedback"],[4,"ngIf"],[2,"font-size","80%","color","#f86c6b"]],template:function(e,t){1&e&&(o.bc(0,"ngx-spinner",0),o.bc(1,"p",1),o.Qc(2,"Loading..."),o.ac(),o.ac(),o.bc(3,"div",2),o.bc(4,"div",3),o.bc(5,"div",4),o.Wb(6,"i",5),o.Qc(7," Update Store Configuration "),o.ac(),o.bc(8,"div",6),o.bc(9,"form",7),o.bc(10,"div",8),o.bc(11,"div",9),o.bc(12,"label"),o.Qc(13,"Contract ID"),o.ac(),o.bc(14,"input",10),o.jc("keyup",(function(e){return t.searchStore(e)}))("ngModelChange",(function(e){return t.selectedContractID=e})),o.ac(),o.Oc(15,ue,2,1,"div",11),o.ac(),o.bc(16,"div",9),o.bc(17,"label"),o.Qc(18,"Store Name & Store Code"),o.ac(),o.Wb(19,"ng-select",12),o.Oc(20,ge,2,1,"div",13),o.ac(),o.bc(21,"div",9),o.bc(22,"label"),o.Qc(23,"Service Provider ID"),o.ac(),o.Wb(24,"ng-select",14),o.Oc(25,me,2,1,"div",11),o.ac(),o.bc(26,"div",9),o.bc(27,"label"),o.Qc(28,"Revenue Share (%)"),o.ac(),o.bc(29,"input",15),o.jc("blur",(function(e){return t.formatData(e.target.value,"revenue")}))("ngModelChange",(function(e){return t.revenue=e})),o.ac(),o.Oc(30,pe,2,1,"div",11),o.ac(),o.bc(31,"div",9),o.bc(32,"label"),o.Qc(33,"GST Rate (%)"),o.ac(),o.bc(34,"input",16),o.jc("blur",(function(e){return t.formatData(e.target.value,"gst")}))("ngModelChange",(function(e){return t.gstRate=e})),o.ac(),o.Oc(35,De,2,1,"div",11),o.ac(),o.bc(36,"div",9),o.bc(37,"label"),o.Qc(38,"TDS Rate (%)"),o.ac(),o.bc(39,"input",17),o.jc("blur",(function(e){return t.formatData(e.target.value,"tds")}))("ngModelChange",(function(e){return t.tdsRate=e})),o.ac(),o.Oc(40,Se,2,1,"div",11),o.ac(),o.bc(41,"div",9),o.bc(42,"label"),o.Qc(43,"Effective Rate (%)"),o.ac(),o.bc(44,"input",18),o.jc("ngModelChange",(function(e){return t.effectiveRate=e})),o.ac(),o.Oc(45,Re,2,1,"div",11),o.ac(),o.bc(46,"div",9),o.bc(47,"label"),o.Qc(48,"Effective Date "),o.ac(),o.bc(49,"input",19),o.jc("ngModelChange",(function(e){return t.effectiveDate=e})),o.ac(),o.Oc(50,Pe,2,1,"div",11),o.ac(),o.ac(),o.bc(51,"div",20),o.Wb(52,"div",21),o.bc(53,"div",22),o.bc(54,"button",23),o.jc("click",(function(){return t.updateConfig()})),o.Qc(55," Update "),o.ac(),o.bc(56,"button",24),o.jc("click",(function(){return t.cancel()})),o.Qc(57," Cancel "),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.ac()),2&e&&(o.uc("fullScreen",!0),o.Ib(9),o.uc("formGroup",t.revenueConfigForm),o.Ib(5),o.uc("ngModel",t.selectedContractID)("ngClass",o.yc(34,Qe,t.formSubmitted&&t.f.contractID.errors))("readonly",!0),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.contractID.errors),o.Ib(4),o.uc("items",t.storeList)("searchable",!0)("ngClass",o.yc(36,we,t.formSubmitted&&t.f.storeID.errors))("readonly",!0),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.storeID.errors),o.Ib(4),o.uc("items",t.serviceProviderList)("searchable",!0)("ngClass",o.yc(38,we,t.formSubmitted&&t.f.serviceProviderID.errors))("readonly",!0),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.serviceProviderID.errors),o.Ib(4),o.uc("ngClass",o.yc(40,Qe,t.formSubmitted&&t.f.percentageTxnCharges.errors))("ngModel",t.revenue),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.percentageTxnCharges.errors),o.Ib(4),o.uc("ngClass",o.yc(42,Qe,t.formSubmitted&&t.f.gstRate.errors))("ngModel",t.gstRate),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.gstRate.errors),o.Ib(4),o.uc("ngModel",t.tdsRate)("ngClass",o.yc(44,Qe,t.formSubmitted&&t.f.tdsRate.errors)),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.tdsRate.errors),o.Ib(4),o.uc("ngClass",o.yc(46,Qe,t.formSubmitted&&t.f.effectiveRate.errors))("ngModel",t.effectiveRate)("readonly",!0),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.effectiveRate.errors),o.Ib(4),o.uc("bsConfig",o.xc(48,Me))("ngModel",t.effectiveDate)("ngClass",o.yc(49,Qe,t.formSubmitted&&t.f.effectiveDate.errors))("minDate",t.minDate),o.Ib(1),o.uc("ngIf",t.formSubmitted&&t.f.effectiveDate.errors))},directives:[l.a,n.A,n.o,n.h,n.b,n.n,n.f,i.l,i.n,b.a,g.a,h.b,h.a],styles:["label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:2px;padding-top:10px}.error[_ngcontent-%COMP%]{border:1px solid #f86c6b;border-radius:4%}  .ng-select-disabled .ng-arrow-wrapper{cursor:default;display:none!important}"]}),e})();function xe(e,t){if(1&e&&(o.bc(0,"div",16),o.bc(1,"p"),o.bc(2,"strong"),o.Qc(3,"Contract ID :"),o.ac(),o.Qc(4),o.bc(5,"strong"),o.Qc(6,"Store Code :"),o.ac(),o.Qc(7),o.bc(8,"strong"),o.Qc(9,"Store Name :"),o.ac(),o.Qc(10),o.ac(),o.ac()),2&e){const e=o.nc();o.Ib(4),o.Sc(" ",null==e.filterQueryStoreID?null:e.filterQueryStoreID.contractId," , \xa0 "),o.Ib(3),o.Sc(" ",null==e.filterQueryStoreID?null:e.filterQueryStoreID.value," , \xa0 "),o.Ib(3),o.Sc(" ",null==e.filterQueryStoreID?null:e.filterQueryStoreID.name," \xa0 ")}}function Fe(e,t){if(1&e&&(o.bc(0,"th"),o.Qc(1),o.ac()),2&e){const e=t.$implicit;o.Ib(1),o.Sc(" ",e.label," ")}}function Le(e,t){if(1&e&&(o.bc(0,"span"),o.Qc(1),o.ac()),2&e){const e=o.nc().$implicit,t=o.nc().$implicit,c=o.nc(3);o.Ib(1),o.Rc(c.getData(t[e.field],e.field,t))}}function Ve(e,t){if(1&e&&(o.bc(0,"span"),o.Qc(1),o.oc(2,"date"),o.ac()),2&e){const e=o.nc(2).$implicit;o.Ib(1),o.Rc(o.qc(2,1,e.effectiveDate,"MM/dd/yyyy"))}}function Te(e,t){if(1&e&&(o.bc(0,"td",35),o.Oc(1,Le,2,1,"span",21),o.Oc(2,Ve,3,4,"span",21),o.ac()),2&e){const e=t.$implicit;o.Ib(1),o.uc("ngIf","effectiveDate"!==e.field),o.Ib(1),o.uc("ngIf","effectiveDate"===e.field)}}function Ne(e,t){if(1&e){const e=o.cc();o.bc(0,"i",36),o.jc("click",(function(){o.Ic(e);const t=o.nc().$implicit;return o.nc(3).openEditModal(t)})),o.ac()}}function qe(e,t){if(1&e&&(o.bc(0,"tr",31),o.Oc(1,Te,3,2,"td",32),o.bc(2,"td",33),o.Oc(3,Ne,1,0,"i",34),o.ac(),o.ac()),2&e){const e=t.$implicit,c=o.nc(3);o.uc("ngClass",e.color?"highlight":e.isFuture?"azure-color":"grey-color"),o.Ib(1),o.uc("ngForOf",c.cols),o.Ib(2),o.uc("ngIf",e.isFuture)}}function Ae(e,t){1&e&&(o.bc(0,"span"),o.bc(1,"button",38),o.Qc(2," + Add New"),o.ac(),o.ac())}function Ee(e,t){if(1&e&&(o.bc(0,"td",37),o.Oc(1,Ae,3,0,"span",21),o.ac()),2&e){const e=t.$implicit;o.Ib(1),o.uc("ngIf","effectiveDate"===e.field)}}const je=function(e,t){return{itemsPerPage:e,currentPage:t}};function $e(e,t){if(1&e&&(o.bc(0,"tbody"),o.Oc(1,qe,4,3,"tr",29),o.oc(2,"paginate"),o.bc(3,"tr"),o.Oc(4,Ee,2,1,"td",30),o.ac(),o.ac()),2&e){const e=o.nc(2);o.Ib(1),o.uc("ngForOf",o.qc(2,2,e.revenueShareList,o.zc(5,je,e.itemsPerPage,e.page))),o.Ib(3),o.uc("ngForOf",e.cols)}}function _e(e,t){1&e&&(o.bc(0,"div",39),o.bc(1,"a",40),o.Qc(2," No Data found ! "),o.Wb(3,"br"),o.bc(4,"button",41),o.Qc(5," + Add New"),o.ac(),o.ac(),o.ac())}function Ue(e,t){if(1&e){const e=o.cc();o.bc(0,"div",17),o.bc(1,"div",18),o.bc(2,"table",19),o.bc(3,"thead"),o.bc(4,"tr"),o.Oc(5,Fe,2,1,"th",20),o.bc(6,"th"),o.Qc(7,"Actions"),o.ac(),o.ac(),o.ac(),o.Oc(8,$e,5,8,"tbody",21),o.ac(),o.Oc(9,_e,6,0,"div",22),o.ac(),o.bc(10,"div",23),o.bc(11,"div",24),o.bc(12,"div",8),o.bc(13,"div",25),o.bc(14,"div",26),o.jc("click",(function(){return o.Ic(e),o.nc().itemOnPage(10)})),o.Qc(15," 10"),o.ac(),o.bc(16,"div",26),o.jc("click",(function(){return o.Ic(e),o.nc().itemOnPage(15)})),o.Qc(17," 15"),o.ac(),o.bc(18,"div",26),o.jc("click",(function(){return o.Ic(e),o.nc().itemOnPage(20)})),o.Qc(19," 20"),o.ac(),o.bc(20,"div",26),o.jc("click",(function(){return o.Ic(e),o.nc().itemOnPage(25)})),o.Qc(21," 25"),o.ac(),o.ac(),o.ac(),o.bc(22,"div",27),o.bc(23,"pagination-controls",28),o.jc("pageChange",(function(t){o.Ic(e);const c=o.nc();return c.pageChanged(c.page=t)})),o.ac(),o.ac(),o.ac(),o.ac(),o.ac()}if(2&e){const e=o.nc();o.Ib(5),o.uc("ngForOf",e.cols),o.Ib(3),o.uc("ngIf",e.revenueShareList.length>0),o.Ib(1),o.uc("ngIf",0===e.totalRecords),o.Ib(5),o.uc("ngClass",10==e.itemsPerPage?"item-number-active":"item-number"),o.Ib(2),o.uc("ngClass",15==e.itemsPerPage?"item-number-active":"item-number"),o.Ib(2),o.uc("ngClass",20==e.itemsPerPage?"item-number-active":"item-number"),o.Ib(2),o.uc("ngClass",25==e.itemsPerPage?"item-number-active":"item-number")}}let Ge=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.spinner=t,this.modalService=c,this.serviceConfigurationService=i,this.dataFilter=n,this.notification=a,this.userService=o,this.cols=[{label:"Service Provider ID",field:"serviceProviderID"},{label:"Revenue Share %",field:"percentageTxnCharges"},{label:"GST Rate %",field:"gstRate"},{label:"TDS Rate %",field:"tdsRate"},{label:"Effective Rate %",field:"effectiveRate"},{label:"Effective From",field:"effectiveDate"}],this.filterQueryStoreID=null,this.filterQueryContractID=null,this.itemsPerPage=10,this.page=1,this.dateArray=[],this.storeList=[],this.revenueShareList=[],this.searchedData=!1,this.isChecker=!1,this.offset=0,this.router.events.subscribe(e=>{e instanceof r.b&&"/service-provider/checker"===e.url&&(this.isChecker=!0)})}ngOnInit(){localStorage.removeItem("service-config"),this.getDropdownVals()}getDropdownVals(){const e=[];this.serviceConfigurationService.getStoreDropdown({merchantId:this.userService.userValue.merchantId}).subscribe(t=>{t&&(t.forEach(t=>{e.push({label:t.storeId+" - "+t.storeName,value:t.storeId,contractId:t.contractId,name:t.storeName,searched:t.storeId+"-"+t.storeName+"-"+t.contractId,merchantId:t.merchantid})}),this.allList=e)})}searchStore(e){if(!this.filterQueryContractID)return this.storeList=[];this.storeList=this.dataFilter.transform(this.allList,e.target.value),this.filterQueryStoreID=null}pageChanged(e){this.page=e,this.offset=this.page-1}itemOnPage(e){this.page=0,this.itemsPerPage=e}getPage(){return this.itemsPerPage?this.itemsPerPage:10}getData(e,t,c){return"effectiveRate"===t?(c.percentageTxnCharges/(100+c.gstRate)*(100-c.tdsRate)).toFixed(2):e}isPastDate(){const e=this.revenueShareList.find(e=>{var t,c;return e.effectiveDate===(null===(c=this.dateArray[(null===(t=this.dateArray)||void 0===t?void 0:t.length)-1])||void 0===c?void 0:c.effectiveDate)});if(e)return e.color=!0}openEditModal(e){this.setOnLocal(),this.bsModalRef=this.modalService.show(ke,{initialState:{data:e},class:"modal-lg",backdrop:"static",keyboard:!1,animated:!0}),this.bsModalRef.content.passData.subscribe(e=>{this.displayData()})}SearcFnc(){if(this.pageChanged(1),!this.filterQueryContractID||!this.filterQueryStoreID)return this.notification.showInfo("Please enter Valid contract ID , Store Name or Store ID","");this.setOnLocal(),this.spinner.show(),this.displayData()}setOnLocal(){localStorage.setItem("service-config",JSON.stringify({storeId:this.filterQueryStoreID.value,storeName:this.filterQueryStoreID.name,contractId:this.filterQueryStoreID.contractId,merchantId:this.filterQueryStoreID.merchantId}))}displayData(){this.serviceConfigurationService.getConfigList({merchantID:this.filterQueryStoreID.merchantId}).subscribe(e=>{this.searchedData=!0,this.revenueShareList=e,this.totalRecords=this.revenueShareList?this.revenueShareList.length:0,this.revenueShareList=this.revenueShareList.sort((function(e,t){return e.effectiveDate-t.effectiveDate})),this.revenueShareList.forEach(e=>{e.contractID=this.filterQueryStoreID.contractId,e.storeName=this.filterQueryStoreID.name,e.storeID=this.filterQueryStoreID.value,e.effectiveDate<Date.parse((new Date).toISOString())||e.effectiveDate===Date.parse((new Date).toISOString())?this.dateArray.push(e):e.isFuture=!0}),this.spinner.hide(),this.isPastDate()})}}return e.\u0275fac=function(t){return new(t||e)(o.Vb(r.c),o.Vb(l.c),o.Vb(E.b),o.Vb(f.a),o.Vb(s),o.Vb(u.a),o.Vb(d.a))},e.\u0275cmp=o.Pb({type:e,selectors:[["app-revenue-share-configuartion"]],features:[o.Hb([s])],decls:24,vars:8,consts:[["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-spin-fade",3,"fullScreen"],[2,"color","white"],[1,"animated","fadeIn"],[1,"card","mt-3"],[1,"card-header","pt-0",2,"font-weight","700"],[1,"fa","fa-th-large","ml-2","mt-3"],[1,"card-body","pb-0","pt-2",3,"ngClass"],[1,"row","mb-3"],[1,"col-md-4"],[1,"input-group"],["type","text",1,"form-control",3,"ngModel","ngModelChange","keyup"],["bindLabel","label","appendTo","body",3,"items","searchable","ngModel","ngModelChange"],[1,"col-md-4","pt-4"],[1,"btn","btn-primary","mt-1",3,"click"],["style","margin-top:-10px ;","class","pb-2 pl-2",4,"ngIf"],["class","card ","style","margin-top:-15px ;",4,"ngIf"],[1,"pb-2","pl-2",2,"margin-top","-10px"],[1,"card",2,"margin-top","-15px"],[1,"card-body","pt-1","pl-1","pr-1","pb-0",2,"overflow-x","scroll"],[1,"table","table-responsive-lg"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","pb-2","style","text-align:center;",4,"ngIf"],[1,"card-footer","pt-2","pb-1"],[1,"row"],[1,"mt-1"],[3,"ngClass","click"],[1,"col-md-8"],[1,"float-right","mr-1",3,"pageChange"],[3,"ngClass",4,"ngFor","ngForOf"],["class","p-0","style","line-height:0;border:none;",4,"ngFor","ngForOf"],[3,"ngClass"],["class","p-2 pl-3",4,"ngFor","ngForOf"],[1,"p-2"],["class","fa fa-pencil m-2","data-toggle","tooltip","data-placement","top","title","Edit",3,"click",4,"ngIf"],[1,"p-2","pl-3"],["data-toggle","tooltip","data-placement","top","title","Edit",1,"fa","fa-pencil","m-2",3,"click"],[1,"p-0",2,"line-height","0","border","none"],["routerLink","/service-provider/add-revenue-share-config",1,"btn","btn-sm","btn-block","btn-primary","mt-2"],[1,"pb-2",2,"text-align","center"],["href","javascript:void(0)",2,"font-size","16px","font-weight","500"],["routerLink","/service-provider/add-revenue-share-config",1,"btn","btn-sm","btn-primary","mt-2","pl-5","pr-5"]],template:function(e,t){1&e&&(o.bc(0,"ngx-spinner",0),o.bc(1,"p",1),o.Qc(2,"Loading..."),o.ac(),o.ac(),o.bc(3,"div",2),o.bc(4,"div",3),o.bc(5,"div",4),o.Wb(6,"i",5),o.Qc(7," Store Configuration "),o.ac(),o.bc(8,"div",6),o.bc(9,"div",7),o.bc(10,"div",8),o.bc(11,"label"),o.Qc(12," Contract ID or Store Name or Store Code"),o.ac(),o.bc(13,"div",9),o.bc(14,"input",10),o.jc("ngModelChange",(function(e){return t.filterQueryContractID=e}))("keyup",(function(e){return t.searchStore(e)})),o.ac(),o.ac(),o.ac(),o.bc(15,"div",8),o.bc(16,"label"),o.Qc(17," Store Code "),o.ac(),o.bc(18,"ng-select",11),o.jc("ngModelChange",(function(e){return t.filterQueryStoreID=e})),o.ac(),o.ac(),o.bc(19,"div",12),o.bc(20,"button",13),o.jc("click",(function(){return t.SearcFnc()})),o.Qc(21," Search"),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.Oc(22,xe,11,3,"div",14),o.Oc(23,Ue,24,7,"div",15),o.ac()),2&e&&(o.uc("fullScreen",!0),o.Ib(8),o.uc("ngClass",t.searchedData?"":"mb-3"),o.Ib(6),o.uc("ngModel",t.filterQueryContractID),o.Ib(4),o.uc("items",t.storeList)("searchable",!0)("ngModel",t.filterQueryStoreID),o.Ib(4),o.uc("ngIf",t.searchedData),o.Ib(1),o.uc("ngIf",t.searchedData))},directives:[l.a,i.l,n.b,n.n,n.q,b.a,i.n,i.m,$.c,r.d],pipes:[$.b,i.e],styles:[".card[_ngcontent-%COMP%]{width:100%!important}.item-number[_ngcontent-%COMP%], .item-number-active[_ngcontent-%COMP%]{display:inline-block;border:1px solid hsla(0,0%,50.2%,.7);padding-left:9px;padding-right:9px;padding-top:2px;height:30px;cursor:pointer;margin:1px}.item-number-active[_ngcontent-%COMP%]{background-color:#2199e8;color:#fff}th[_ngcontent-%COMP%]{border-top:none}label[_ngcontent-%COMP%]{font-weight:500}.badge[_ngcontent-%COMP%]{font-size:13px;color:#fff}th[_ngcontent-%COMP%]{white-space:nowrap}.highlight[_ngcontent-%COMP%]{background-color:#0ff}.grey-color[_ngcontent-%COMP%]{background-color:#ededed}.azure-color[_ngcontent-%COMP%]{background-color:#faffff}"]}),e})();var ze=c("wd/R"),Be=c("id1S"),We=c("bpDJ"),Ye=c("kFe1");function He(e,t){if(1&e&&(o.bc(0,"span"),o.Qc(1),o.ac()),2&e){const e=o.nc().$implicit;o.Ib(1),o.Sc(" ",e.label," \xa0 ")}}function Je(e,t){if(1&e&&(o.bc(0,"th"),o.Zb(1,27),o.Oc(2,He,2,1,"span",28),o.Yb(),o.ac()),2&e){const e=t.$implicit;o.Ib(1),o.uc("ngSwitch",e.field)}}function Ze(e,t){if(1&e&&(o.bc(0,"div"),o.Qc(1),o.ac()),2&e){const e=o.nc().$implicit,t=o.nc().$implicit;o.Ib(1),o.Rc(t[e.field])}}function Ke(e,t){if(1&e&&(o.bc(0,"div"),o.Qc(1),o.oc(2,"date"),o.ac()),2&e){const e=o.nc().$implicit,t=o.nc().$implicit;o.Ib(1),o.Rc(o.qc(2,1,1e3*t[e.field],"dd/MM/yyyy h:mma"))}}function Xe(e,t){if(1&e&&(o.bc(0,"div"),o.Qc(1),o.oc(2,"date"),o.ac()),2&e){const e=o.nc().$implicit,t=o.nc().$implicit;o.Ib(1),o.Rc(o.qc(2,1,1e3*t[e.field],"dd/MM/yyyy h:mma"))}}function et(e,t){if(1&e&&(o.bc(0,"div"),o.Qc(1),o.oc(2,"date"),o.ac()),2&e){const e=o.nc().$implicit,t=o.nc().$implicit;o.Ib(1),o.Rc(o.qc(2,1,1e3*t[e.field],"dd/MM/yyyy h:mma"))}}function tt(e,t){if(1&e&&(o.bc(0,"td"),o.Oc(1,Ze,2,1,"div",30),o.Oc(2,Ke,3,4,"div",30),o.Oc(3,Xe,3,4,"div",30),o.Oc(4,et,3,4,"div",30),o.ac()),2&e){const e=t.$implicit;o.Ib(1),o.uc("ngIf","fromDate"!=e.field&&"toDate"!=e.field&&"createdAt"!=e.field&&"status"!=e.field),o.Ib(1),o.uc("ngIf","fromDate"==e.field),o.Ib(1),o.uc("ngIf","toDate"==e.field),o.Ib(1),o.uc("ngIf","createdAt"==e.field)}}function ct(e,t){1&e&&(o.bc(0,"div",31),o.bc(1,"button",32),o.Qc(2," FAILED "),o.ac(),o.ac())}function it(e,t){if(1&e){const e=o.cc();o.bc(0,"div",31),o.bc(1,"button",33),o.jc("click",(function(){o.Ic(e);const t=o.nc().$implicit;return o.nc().downloadreport(t,t.id)})),o.Qc(2," Download "),o.ac(),o.ac()}}function rt(e,t){1&e&&(o.bc(0,"div",31),o.bc(1,"button",34),o.Qc(2," PROCESSING.. "),o.ac(),o.ac())}function nt(e,t){if(1&e&&(o.bc(0,"tr"),o.Oc(1,tt,5,4,"td",19),o.bc(2,"td"),o.Oc(3,ct,3,0,"div",29),o.Oc(4,it,3,0,"div",29),o.Oc(5,rt,3,0,"div",29),o.ac(),o.ac()),2&e){const e=t.$implicit,c=o.nc();o.Ib(1),o.uc("ngForOf",c.cols),o.Ib(2),o.uc("ngIf","FAILED"==e.status),o.Ib(1),o.uc("ngIf","COMPLETED"==e.status),o.Ib(1),o.uc("ngIf","IN_PROGRESS"==e.status)}}function at(e,t){if(1&e){const e=o.cc();o.bc(0,"div",35),o.jc("click",(function(){o.Ic(e);const c=t.$implicit;return o.nc().itemOnPage(c)})),o.Qc(1),o.ac()}if(2&e){const e=t.$implicit,c=o.nc();o.uc("ngClass",c.itemsPerPage==e?"item-number-active":"item-number"),o.Ib(1),o.Sc(" ",e," ")}}const ot=function(e,t,c){return{itemsPerPage:e,currentPage:t,totalItems:c}},st=[{path:"",data:{title:"Service Provider Configuration"},children:[{path:"revenue-share-config",component:Ge,data:{title:"Revenue Share Configuration"}},{path:"add-revenue-share-config",component:T,data:{title:"Add Revenue Share Configuration"}},{path:"view-revenue-share-config/:id",component:de,data:{title:"View Revenue Share Configuration"}},{path:"checker",component:le,data:{title:"Checker Revenue Share Configuration"}},{path:"audit-report",component:(()=>{class e{constructor(e,t,c,i,r){this.userService=e,this.transactionService=t,this.notificationService=c,this.excelService=i,this.serviceConfigurationService=r,this.storeList=[],this.filteredData=[],this.filterQueryStoreID="All",this.selected={startDate:ze("00:00","HH:mm").subtract(7,"days"),endDate:ze("23:59","HH:mm")},this.ranges={Today:[ze().set("hours",0).set("minutes",0),ze().set("hours",23).set("minutes",59)],"Last 7 Days":[ze().subtract(6,"days"),ze()],"Last 30 Days":[ze().subtract(29,"days"),ze()],"Last 3 Month":[ze().subtract(3,"month").startOf("month"),ze().subtract(1,"month").endOf("month")],"Last 6 Months":[ze().subtract(6,"month").startOf("month"),ze().subtract(1,"month").endOf("month")]},this.cols=[{label:"From Date",field:"fromDate",sortOptions:"",sort:"number"},{label:"To Date",field:"toDate",sortOptions:"",sort:"number"},{label:"Created At",field:"createdAt",sortOptions:"",sort:"number"},{label:"Created By",field:"createdBy",sortOptions:"",sort:"text"}],this.page=1,this.entriesOnPage=[5,10,15,20],this.itemsPerPage=5,this.recordPerPage=100,this.offset=0,this.datas=[]}showReports(){if(!this.filterQueryStoreID)return this.notificationService.showInfo("Please select Store ID.","");this.filteredData=[];let e=ze(this.selectedDateRange.startDate).unix(),t=ze(this.selectedDateRange.endDate).unix(),c=Object.assign({fromDate:e,toDate:t,reportType:"AUDIT",merchantID:this.filterQueryStoreID,merchantType:this.userService.userValue.merchantType},"AGG"==this.userService.userValue.merchantType?{aggregatorID:this.userService.userValue.merchantId}:null);console.log(c),this.transactionService.generateReportsTransaction(c).subscribe(e=>{e.duplicateId==e.id&&null!=e.remarks?this.notificationService.showInfo("Report for specified date range is already generated.",""):this.getAllReports()}),setTimeout(()=>{this.getAllReports()},2e3)}downloadreport(e,t){if(null==e.count)return this.notificationService.showInfo("Data is not available","");this.datas=[],this.transactionService.downloadReport(t,e.merchantID,"AGG"===this.userService.userValue.merchantType?this.userService.userValue.merchantId:null).subscribe(t=>{this.datas.push(t),new Date,this.excelService.downloadFile(this.datas,e.fileName)})}ngOnInit(){this.getDropdownVals(),this.loggedInUser=this.userService.userValue,this.selectedDateRange=this.selected,this.showReportsData=[],"AGG"===this.userService.userValue.merchantType&&(this.merchantId="ALL"),this.getAllReports()}getAllReports(){let e={reportType:"AUDIT",merchantID:this.filterQueryStoreID,merchantType:this.userService.userValue.merchantType};this.transactionService.getReportsTransaction(e.reportType,e.merchantID,this.recordPerPage,this.offset,"AGG"===this.userService.userValue.merchantType?this.userService.userValue.merchantId:null).subscribe(e=>{this.showReportsData=e})}pageChanged(e){this.page=e}itemOnPage(e){this.itemsPerPage=e}selectMer(){this.getAllReports()}getDropdownVals(){const e=[{label:"ALL",value:"",merchantId:"All"}];this.serviceConfigurationService.getStoreDropdown({merchantId:this.userService.userValue.merchantId}).subscribe(t=>{t&&(t.forEach(t=>{e.push({label:t.storeId+" - "+t.storeName,value:t.storeId,merchantId:t.merchantid})}),this.storeList=e)})}}return e.\u0275fac=function(t){return new(t||e)(o.Vb(d.a),o.Vb(Be.a),o.Vb(u.a),o.Vb(We.a),o.Vb(f.a))},e.\u0275cmp=o.Pb({type:e,selectors:[["app-audit-report"]],decls:43,vars:24,consts:[[1,"container-fluid","p-0",2,"min-height","80vh"],[1,"row"],[1,"card","mt-3"],[1,"card-body",2,"padding-top","0","padding-left","15px","padding-right","15px"],[1,"row","mb-2"],[1,"col-md-12","card-header",2,"font-weight","700"],[1,"fa","fa-list-alt","ml-2",2,"font-weight","500"],[1,"col-md-12"],[1,"row","pl-3","pr-5"],[1,"col-md-5"],["id","calendar-input","type","text","ngxDaterangepickerMd","",1,"form-control",3,"dateLimit","ngModel","autoApply","showCustomRangeLabel","alwaysShowCalendars","ranges","linkedCalendars","keepCalendarOpeningWithRange","timePicker","timePicker24Hour","showClearButton","ngModelChange"],["id","icon","for","calendar-input",1,"date-range-picker-icon","fa","fa-calendar"],[1,"col-md-3"],["bindLabel","label","appendTo","body","bindValue","merchantId",3,"items","searchable","ngModel","ngModelChange","change"],[1,"col-md-2","mt-2"],[1,"btn","btn-sm","btn-primary","mt-4",3,"click"],[1,"card"],[1,"card-body","pb-0","show-data"],[1,"table","table-striped","table-hover","table-responsive-lg"],[4,"ngFor","ngForOf"],[1,"card-footer"],[1,"row","col-md-12",2,"float","left"],[1,"col-md-4","d-inline-flex"],[1,"p-2"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"float-right",3,"pageChange"],[3,"ngSwitch"],[4,"ngSwitchDefault"],["class","col-md-1",4,"ngIf"],[4,"ngIf"],[1,"col-md-1"],[1,"btn","btn-sm","btn-danger","mt-4"],[1,"btn","btn-sm","btn-primary","mt-1",3,"click"],[1,"btn","btn-sm","btn-info","mt-4"],[3,"ngClass","click"]],template:function(e,t){1&e&&(o.bc(0,"div",0),o.bc(1,"div",1),o.bc(2,"div",2),o.bc(3,"div",3),o.bc(4,"div",4),o.bc(5,"div",5),o.Wb(6,"i",6),o.Qc(7,"AUDIT "),o.ac(),o.ac(),o.bc(8,"div",1),o.bc(9,"div",7),o.bc(10,"div",8),o.bc(11,"div",9),o.bc(12,"label"),o.Qc(13,"Duration"),o.ac(),o.bc(14,"input",10),o.jc("ngModelChange",(function(e){return t.selectedDateRange=e})),o.ac(),o.Wb(15,"label",11),o.ac(),o.bc(16,"div",12),o.bc(17,"label"),o.Qc(18," Store ID "),o.ac(),o.bc(19,"ng-select",13),o.jc("ngModelChange",(function(e){return t.filterQueryStoreID=e}))("change",(function(){return t.selectMer()})),o.ac(),o.ac(),o.bc(20,"div",14),o.bc(21,"button",15),o.jc("click",(function(){return t.showReports()})),o.Qc(22," Generate Report "),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.bc(23,"div",16),o.bc(24,"div",17),o.bc(25,"table",18),o.bc(26,"thead"),o.bc(27,"tr"),o.Oc(28,Je,3,1,"th",19),o.ac(),o.ac(),o.bc(29,"tbody"),o.Oc(30,nt,6,4,"tr",19),o.oc(31,"paginate"),o.ac(),o.ac(),o.ac(),o.bc(32,"div",20),o.bc(33,"div",21),o.bc(34,"div",22),o.bc(35,"span",23),o.Qc(36," Show "),o.ac(),o.Oc(37,at,2,2,"div",24),o.bc(38,"span",23),o.Qc(39," entries per page "),o.ac(),o.ac(),o.Wb(40,"div",25),o.bc(41,"div",25),o.bc(42,"pagination-controls",26),o.jc("pageChange",(function(e){return t.pageChanged(e)})),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.ac(),o.ac()),2&e&&(o.Ib(14),o.uc("dateLimit",90)("ngModel",t.selectedDateRange)("autoApply",!1)("showCustomRangeLabel",!1)("alwaysShowCalendars",!0)("ranges",t.ranges)("linkedCalendars",!0)("keepCalendarOpeningWithRange",!0)("timePicker",!0)("timePicker24Hour",!0)("showClearButton",!1),o.Ib(5),o.uc("items",t.storeList)("searchable",!0)("ngModel",t.filterQueryStoreID),o.Ib(9),o.uc("ngForOf",t.cols),o.Ib(2),o.uc("ngForOf",o.qc(31,17,t.showReportsData,o.Ac(20,ot,t.itemsPerPage,t.page,t.showReportsData.length))),o.Ib(7),o.uc("ngForOf",t.entriesOnPage))},directives:[Ye.a,n.b,n.n,n.q,b.a,i.m,$.c,i.p,i.r,i.n,i.l],pipes:[$.b,i.e],styles:[".card[_ngcontent-%COMP%]{width:100%!important}.item-number[_ngcontent-%COMP%], .item-number-active[_ngcontent-%COMP%]{display:inline-block;border:1px solid hsla(0,0%,50.2%,.7);padding-left:9px;padding-right:9px;padding-top:2px;height:30px;cursor:pointer;margin:1px}.item-number-active[_ngcontent-%COMP%]{background-color:#2199e8;color:#fff}th[_ngcontent-%COMP%]{border-top:none}.dropdown-menu[_ngcontent-%COMP%]{min-width:0}.show-data[_ngcontent-%COMP%]{overflow-x:scroll}  .md-drppicker{width:600px!important}label[_ngcontent-%COMP%]{font-weight:500}#icon[_ngcontent-%COMP%]{float:right;margin-top:-24px;font-size:17px;padding-right:8px}"]}),e})(),data:{title:"Audit report "}}]}];let lt=(()=>{class e{}return e.\u0275mod=o.Tb({type:e}),e.\u0275inj=o.Sb({factory:function(t){return new(t||e)},imports:[[r.g.forChild(st)],r.g]}),e})();var dt=c("FE24"),ft=c("d2mR");let ut=(()=>{class e{}return e.\u0275mod=o.Tb({type:e}),e.\u0275inj=o.Sb({factory:function(t){return new(t||e)},providers:[E.b],imports:[[i.c,lt,$.a,ft.a,dt.c,n.i,Ye.b.forRoot(),l.b,h.c.forRoot(),E.d.forRoot(),n.i,n.v,b.b,g.b.forRoot()]]}),e})()}}]);